<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Result</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            min-height: 100vh;
            perspective: 1000px;
            overflow-x: hidden;
            color: white;
        }

        /* 3D Tilt Logic */
        .tilt-wrapper {
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
            will-change: transform;
        }

        /* Depth Layers */
        .layer-base { transform: translateZ(0px); }
        .layer-1 { transform: translateZ(20px); }
        .layer-2 { transform: translateZ(35px); }
        .layer-3 { transform: translateZ(50px); }
        
        /* Floating background particles */
        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.5;
            pointer-events: none;
        }

        /* Glass Table Styling */
        .glass-table th {
            background-color: rgba(255, 255, 255, 0.05);
            color: #22d3ee; /* Cyan-400 */
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .glass-table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: #cbd5e1; /* Slate-300 */
        }

        .glass-table tr:hover td {
            background-color: rgba(255, 255, 255, 0.03);
            color: white;
        }

        .glass-table .total-row td {
            border-top: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: bold;
            background-color: rgba(34, 211, 238, 0.1); /* Cyan tint */
        }

        /* Print Styles - Reverts everything to simple white paper format */
        @media print {
            body {
                background: white !important;
                color: black !important;
                perspective: none !important;
                overflow: visible !important;
                display: block !important;
            }
            .orb, .print-hidden {
                display: none !important;
            }
            .tilt-wrapper {
                transform: none !important;
                box-shadow: none !important;
                background: white !important;
                border: 1px solid #ccc !important;
                margin-bottom: 2rem !important;
                padding: 1rem !important;
                page-break-after: always;
            }
            .glass-table th {
                background-color: #f3f4f6 !important;
                color: black !important;
                border: 1px solid #000 !important;
            }
            .glass-table td {
                color: black !important;
                border: 1px solid #000 !important;
            }
            .text-transparent {
                color: black !important;
                background: none !important;
                -webkit-text-fill-color: black !important;
            }
            .glass-panel-item {
                border: none !important;
                background: none !important;
            }
        }
    </style>
</head>

<body class="selection:bg-cyan-500 selection:text-white py-12 px-4 flex flex-col items-center gap-12">

    <!-- Background Orbs -->
    <div class="orb w-full h-96 bg-purple-600 top-0 left-0 -translate-y-1/2 opacity-30"></div>
    <div class="orb w-96 h-96 bg-cyan-600 bottom-0 right-0 translate-x-1/3 translate-y-1/3 opacity-30"></div>

    {% for student in results %}
    
    <!-- 3D Card Container (One per student) -->
    <div class="tilt-wrapper relative bg-slate-900/50 backdrop-blur-xl border border-white/10 p-8 rounded-3xl shadow-2xl max-w-4xl w-full mx-auto">
        
        <!-- Decorative Glow -->
        <div class="absolute inset-0 bg-gradient-to-br from-white/5 to-transparent rounded-3xl pointer-events-none"></div>

        <!-- HEADER -->
        <div class="layer-3 text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-300 via-white to-purple-300 tracking-tight uppercase mb-2">
                Academic Progress Report
            </h1>
            <div class="h-1 w-24 bg-gradient-to-r from-cyan-500 to-purple-500 mx-auto rounded-full"></div>
        </div>

        <!-- STUDENT INFO GRID -->
        <div class="layer-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
            <div class="glass-panel-item bg-white/5 border border-white/10 rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-cyan-500/20 flex items-center justify-center text-cyan-400">
                    <i class="fa-solid fa-user"></i>
                </div>
                <div>
                    <div class="text-xs text-slate-400 uppercase font-bold">Name</div>
                    <div class="font-semibold">{{ student.name }}</div>
                </div>
            </div>

            <div class="glass-panel-item bg-white/5 border border-white/10 rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400">
                    <i class="fa-solid fa-list-ol"></i>
                </div>
                <div>
                    <div class="text-xs text-slate-400 uppercase font-bold">Roll No</div>
                    <div class="font-semibold">{{ student.roll }}</div>
                </div>
            </div>

            <div class="glass-panel-item bg-white/5 border border-white/10 rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-pink-500/20 flex items-center justify-center text-pink-400">
                    <i class="fa-solid fa-graduation-cap"></i>
                </div>
                <div>
                    <div class="text-xs text-slate-400 uppercase font-bold">Class</div>
                    <div class="font-semibold">{{ student.clas }}</div>
                </div>
            </div>

            <div class="glass-panel-item bg-white/5 border border-white/10 rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-yellow-500/20 flex items-center justify-center text-yellow-400">
                    <i class="fa-solid fa-cake-candles"></i>
                </div>
                <div>
                    <div class="text-xs text-slate-400 uppercase font-bold">Date of Birth</div>
                    <div class="font-semibold">{{ student.dob }}</div>
                </div>
            </div>

            <div class="glass-panel-item bg-white/5 border border-white/10 rounded-xl p-4 md:col-span-2 flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center text-green-400">
                    <i class="fa-solid fa-user-shield"></i>
                </div>
                <div>
                    <div class="text-xs text-slate-400 uppercase font-bold">Guardian</div>
                    <div class="font-semibold">{{ student.guard }}</div>
                </div>
            </div>
        </div>

        <!-- RESULT TABLE -->
        <div class="layer-1 overflow-hidden rounded-2xl border border-white/10 shadow-lg shadow-black/20 mb-8">
            <div class="overflow-x-auto">
                <table class="glass-table w-full text-center border-collapse">
                    <thead>
                        <tr>
                            <th class="text-left pl-6">Subject</th>
                            <th colspan="2" class="bg-white/10">Half Yearly</th>
                            <th colspan="2" class="bg-white/10">Final Exam</th>
                            <th colspan="2" class="bg-white/10">Total</th>
                        </tr>
                        <tr class="text-xs text-slate-500 border-b border-white/5">
                            <th></th> <!-- Spacer for Subject -->
                            <th class="py-1">Obtained</th><th class="py-1">Total</th>
                            <th class="py-1">Obtained</th><th class="py-1">Total</th>
                            <th class="py-1">Obtained</th><th class="py-1">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="text-left pl-6 font-medium text-white">Mathematics</td>
                            <td class="bg-white/5">{{ student.hmath }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5">{{ student.fmath }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5 font-bold text-cyan-300">{{ student.maths_total }}</td><td class="text-slate-500">200</td>
                        </tr>
                        <tr>
                            <td class="text-left pl-6 font-medium text-white">Science</td>
                            <td class="bg-white/5">{{ student.hsci }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5">{{ student.fsci }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5 font-bold text-cyan-300">{{ student.sci_total }}</td><td class="text-slate-500">200</td>
                        </tr>
                        <tr>
                            <td class="text-left pl-6 font-medium text-white">History</td>
                            <td class="bg-white/5">{{ student.hhis }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5">{{ student.fhis }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5 font-bold text-cyan-300">{{ student.his_total }}</td><td class="text-slate-500">200</td>
                        </tr>
                        <tr>
                            <td class="text-left pl-6 font-medium text-white">English</td>
                            <td class="bg-white/5">{{ student.heng }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5">{{ student.feng }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5 font-bold text-cyan-300">{{ student.eng_total }}</td><td class="text-slate-500">200</td>
                        </tr>
                        <tr>
                            <td class="text-left pl-6 font-medium text-white">Hindi</td>
                            <td class="bg-white/5">{{ student.hhindi }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5">{{ student.fhindi }}</td><td class="text-slate-500">100</td>
                            <td class="bg-white/5 font-bold text-cyan-300">{{ student.hindi_total }}</td><td class="text-slate-500">200</td>
                        </tr>
                        <tr class="total-row border-t-2 border-cyan-500/30">
                            <td class="text-left pl-6 text-lg uppercase tracking-wider">Grand Total</td>
                            <td class="bg-cyan-900/20 font-bold text-cyan-300">{{ student.half_total }}</td>
                            <td class="bg-cyan-900/20 text-slate-400">500</td>
                            <td class="font-bold text-cyan-300">{{ student.final_total }}</td>
                            <td class="text-slate-400">500</td>
                            <td class="bg-cyan-500/20 text-xl font-extrabold text-cyan-200">{{ student.grand_total }}</td>
                            <td class="bg-cyan-500/20 text-slate-300 font-bold">1000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- FOOTER GRADE -->
        <div class="layer-3 flex justify-between items-center">
             <div class="text-slate-400 text-sm italic print-hidden">
                Generated by Student Portal System
             </div>
             <div class="px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl shadow-lg shadow-purple-500/30 flex items-center gap-3 transform hover:scale-105 transition-transform">
                 <span class="text-white font-bold uppercase tracking-widest text-sm">Overall Grade</span>
                 <span class="text-3xl font-extrabold text-white">{{ student.grade }}</span>
             </div>
        </div>

    </div>

    <!-- Print Page Break Spacer -->
    <div class="h-12 w-full print-hidden"></div>
    
    {% empty %}
    <div class="layer-3 text-center py-20 text-slate-400">
        <i class="fa-regular fa-folder-open text-6xl mb-4 opacity-50"></i>
        <p class="text-xl">No student records found.</p>
    </div>
    {% endfor %}

    <!-- Button to Print (Hidden during printing) -->
    <button onclick="window.print()" class="print-hidden fixed bottom-8 right-8 w-14 h-14 bg-cyan-500 hover:bg-cyan-400 text-white rounded-full shadow-lg shadow-cyan-500/30 flex items-center justify-center transition-all hover:scale-110 z-50">
        <i class="fa-solid fa-print text-xl"></i>
    </button>

    <script>
        const cards = document.querySelectorAll('.tilt-wrapper');
        const MAX_ROTATION = 3; // Kept subtle for large tables

        document.addEventListener('mousemove', (e) => {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const mouseX = e.clientX;
            const mouseY = e.clientY;

            // Normalize mouse position -1 to 1
            const xVal = (mouseX / width - 0.5) * 2;
            const yVal = (mouseY / height - 0.5) * 2;
            
            const rotateY = xVal * MAX_ROTATION;
            const rotateX = -yVal * MAX_ROTATION;
            
            cards.forEach(card => {
                card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            });

            // Parallax Orbs
            document.querySelectorAll('.orb').forEach((orb, index) => {
                const speed = (index + 1) * 10;
                orb.style.transform = `translate(${xVal * -speed}px, ${yVal * -speed}px) translate(0, 0)`; // Removed generic translate to keep positioning relative
            });
        });

        // Reset
        document.addEventListener('mouseleave', () => {
             cards.forEach(card => {
                card.style.transform = `rotateX(0deg) rotateY(0deg)`;
            });
        });
    </script>
</body>
</html>